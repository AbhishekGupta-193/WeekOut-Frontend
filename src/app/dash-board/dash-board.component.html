<!-- Dashboard Header -->
<header class="dashboard-header">
  <!-- Left: Logo + Search -->
  <div class="header-left">
  <div class="logo" (click)="goToHomePage()">
    <div class="logo-icon bg-gradient-to-r from-blue-600 to-purple-600">W</div>
    <span class="logo-text">WeekOut</span>
  </div>
    <div class="search-wrapper">
        <i class="fas fa-search"></i>
        <input type="text" placeholder="Search Plans..." class="search-bar" />
    </div>
  </div>

  <!-- Right: Buttons -->
  <div class="header-right">
    <button class="btn-gradient" (click)="goToCreatePlanPage()">+ Create Plan</button>
    <button class="icon-btn">
      <i class="fas fa-bell"></i>
    </button>
    <button class="icon-btn" (click)="goToUserProfile()">
      <i class="fas fa-user-circle"></i>
    </button>
  </div>
</header>

<!-- Welcome Section -->
<section class="welcome-section bg-gradient-custom">
  <h1>Good morning, {{userName}}! ðŸ‘‹</h1>
  <p>Ready to make this weekend awesome?</p>
</section>

<div class="welcome-buttons">
  <button class="btn-gradient" (click)="goToCreatePlanPage()">+ Create Plan</button>
  <button class="btn-outline">
    <i class="fas fa-fire"></i> Trending
  </button>
</div>

<!-- Toggle Navigation -->
<nav class="toggle-nav">
  <button
    [class.active]="activeTab === 'explore'"
    (click)="setActiveTab('explore');getAllPlansToExplore()"
  >
    Explore Plans
  </button>
  <button
    [class.active]="activeTab === 'forYou'"
    (click)="setActiveTab('forYou');getAllPlansForYou()"
  >
    For You
  </button>
  <button
    [class.active]="activeTab === 'nearby'"
    (click)="setActiveTab('nearby')"
  >
    Nearby Spots
  </button>
</nav>

<!-- Search + Filter Bar -->
<div class="search-filter-bar">
  <div class="search-wrapper2">
    <i class="fas fa-search"></i>
    <input type="text" placeholder="Search Plans..." class="search-bar2" />
  </div>

 <mat-form-field>
  <mat-label>Plan Types</mat-label>
  <mat-select [formControl]="planTypes" multiple>
    <mat-select-trigger>
      {{planTypes.value?.[0] || "All Types"}}
      @if ((planTypes.value?.length || 0) > 1) {
        <span class="example-additional-selection">
          (+{{(planTypes.value?.length || 0) - 1}} {{planTypes.value?.length === 2 ? 'other' : 'others'}})
        </span>
      }
    </mat-select-trigger>
    @for (plan of planList; track plan) {
  <mat-option [value]="plan">{{plan}}</mat-option>
}
  </mat-select>
</mat-form-field>
</div>



<!-- Content Sections -->
<div class="content-section">
  <!-- EXPLORE PLANS -->
  <div class="active-content-section" *ngIf="activeTab === 'explore'">
    <div class="plan-card" *ngFor="let plan of allPlansToExplore">
      <div class="plan-header">
        <i class="fas fa-mountain"></i>
        <h3>{{ plan.title }}</h3>
        <span class="tag">{{ plan.type }}</span>
      </div>
      <p style="margin-bottom: 2.5rem;"><i class="fas fa-calendar"></i> {{ plan.date }} at {{ plan.time }}</p>
      <p><i class="fas fa-map-marker-alt"></i> {{ plan.meetupPoint }}</p>
      <div class="tags">
        <span *ngFor="let tag of plan.tags" class="tag">{{ tag }}</span>
      </div>
      <div class="host">
        <div class="host-name">
          <!-- <span class="host-icon bg-gradient-to-r from-blue-600 to-purple-600">{{ plan.hostInitial }}</span> -->
          <span class="host-icon bg-gradient-to-r from-blue-600 to-purple-600">{{plan.hostUser?.name[0] || 'X'}}</span>
          <div style="margin-top: 3px;">
            {{plan.hostUser?.name || 'Mr XYZ'}}
            <!-- {{getPlanHost(plan.hostId)}} -->
          </div>
        </div>
        <div>
          <i class="fas fa-users"></i> {{ plan.maxMembers }}
        </div>
      </div>
      <div class="plan-actions">
        <button
          *ngIf="!plan.joined"
          class="btn-gradient"
          (click)="joinPlan(plan)"
        >
          Know more about Plan
        </button>
        <div *ngIf="plan.joined" class="joined-actions">
          <button class="btn-outline-custom">
            <i class="fas fa-comments"></i> Chat
          </button>
          <button class="btn-gradient" [routerLink]="['/plan', plan.id]">Details</button>
        </div>
      </div>
    </div>
  </div>

  <!-- FOR YOU -->
  <div class="active-content-section-for-you" *ngIf="activeTab === 'forYou'">
    <div>
      <h4>Based on Your Interests</h4>
      <div class="tags">
        <span class="tag" *ngFor="let interest of userInterests">{{interest}}</span>
      </div>
        <div *ngIf="updateInsterestClicked" class="interests">
            <label *ngFor="let interest of interestsList; let i = index" class="interest-checkbox">
                <input type="checkbox" />
                {{ interest }}
            </label>
        </div>
    </div>
    <div class="for-you-description">
      <i class="fas fa-map fa-3x faded"></i>
      <div>
        <h4>
          No personalized suggestions yet
        </h4>
        <p class="info-text">
          Join more plans or update your interests to get better recommendations.
        </p>
      </div>
      <button *ngIf="!updateInsterestClicked" (click)="onUpdateInterestsClick()">Update Interests</button>
      <div *ngIf="updateInsterestClicked" class="After_Edit_btns">
        <button (click)="onCancelChanges()">Cancel Changes</button>
        <button (click)="onSaveChanges()" style="color: white;background: linear-gradient(to right, #2563eb, #9333ea);">Save Changes</button>
      </div>
    </div>
    <!-- Show Explore Plans Below -->
  <div class="active-content-section">
    <div class="plan-card" *ngFor="let plan of allPlansForYou">
      <div class="plan-header">
        <i class="fas fa-mountain"></i>
        <h3>{{ plan.title }}</h3>
        <span class="tag">{{ plan.type }}</span>
      </div>
      <p style="margin-bottom: 2.5rem;"><i class="fas fa-calendar"></i> {{ plan.date }} at {{ plan.time }}</p>
      <p><i class="fas fa-map-marker-alt"></i> {{ plan.meetupPoint }}</p>
      <div class="tags">
        <span *ngFor="let tag of plan.tags" class="tag">{{ tag }}</span>
      </div>
      <div class="host">
        <div class="host-name">
          <span class="host-icon bg-gradient-to-r from-blue-600 to-purple-600">{{plan.hostUser?.name[0] || 'X'}}</span>
          <div style="margin-top: 3px;">
            {{plan.hostUser?.name || 'Mr XYZ'}}
          </div>
        </div>
        <div>
          <i class="fas fa-users"></i> {{ plan.maxMembers }}
        </div>
      </div>
      <div class="plan-actions">
        <button
          *ngIf="!plan.joined"
          class="btn-gradient"
          (click)="joinPlan(plan)"
        >
          Join Plan
        </button>
        <div *ngIf="plan.joined" class="joined-actions">
          <button class="btn-outline-custom">
            <i class="fas fa-comments"></i> Chat
          </button>
          <button class="btn-gradient" [routerLink]="['/plan', plan.id]">Details</button>
        </div>
      </div>
    </div>
  </div>
  </div>

  <!-- NEARBY SPOTS -->
  <div *ngIf="activeTab === 'nearby'">
    <div class="active-content-section">
      <div class="spot-card" *ngFor="let spot of nearbySpots">
        <div class="spot-header">
          <i class="fas fa-tree"></i>
          <h3>{{ spot.name }}</h3>
          <span class="tag">{{ spot.distance }}</span>
        </div>
        <div class="tags">
          <span *ngFor="let tag of spot.tags" class="tag">{{ tag }}</span>
        </div>
        <p><i class="fas fa-star"></i> {{ spot.rating }} Star</p>
        <button class="btn-gradient" (click)="goToCreatePlanPage()">Create Plan</button>
      </div>
    </div>
    <!-- Bottom Section -->
    <div class="map-coming">
      <i class="fas fa-map fa-3x faded"></i>
      <p>Interactive map coming soon</p>
      <small>
        Discover nearby spots and plan meetups
      </small>
    </div>
  </div>
</div>
